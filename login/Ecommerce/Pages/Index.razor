@page "/"
@using Ecommerce.Models
@using Newtonsoft.Json;
@inject IJSRuntime JSRuntime
@inject NavigationManager NavigationManager
<PageTitle>EShop</PageTitle>



@code{
    public List<Products> Product { get; set; }
    private string searchQuery;

protected override async Task OnInitializedAsync()
    {
        var uri = new Uri(NavigationManager.Uri);
        if (uri.Query.Contains("search="))
        {
            searchQuery = uri.Query.Split("=")[1];
        }

        Product = await GetProduct();
    }

    private async Task<List<Products>> GetProduct()
    {
        var baseUrl = "https://localhost:7044/api/products/all";
        using (var httpClientHandler = new HttpClientHandler())
        {
            httpClientHandler.ServerCertificateCustomValidationCallback = HttpClientHandler.DangerousAcceptAnyServerCertificateValidator;
            using (var httpClient = new HttpClient(httpClientHandler))
            {
                var jsonStr = await httpClient.GetStringAsync(baseUrl);
                var products = JsonConvert.DeserializeObject<List<Products>>(jsonStr);

                if (!string.IsNullOrEmpty(searchQuery))
                {
                    // Filter products based on the search query
                    products = products.Where(p => p.ProdName.ToLower().Contains(searchQuery.ToLower())).ToList();
                }

                return products;
            }
        }
    }




}


<div>
    <div class="d-flex justify-content-center m-5 p-5 carousel-container align-items-start">
           <div style="position: absolute; top: 50%; left: 12%; transform: translate(-50%, -50%);">
        <img src="../../../Assets/female.png" alt="Image" style="width: 300px;height: 262px;" />
    </div>
        <div id="carouselExampleAutoplaying" class="carousel slide rounded-end" data-bs-ride="carousel" data-bs-interval="2000">
            <div class="carousel-inner">
                @if (Product != null)
                {
                    @foreach (var item in Product)
                    {
                        <div class="carousel-item @(item.ProdId == 1 ? "active" : "")">
                            <a href="@($"/details/{item.ProdId}")">
                                <img src="@item.ImageURL" class="d-block w-100" style="object-fit: contain; max-height: 220px;" />
                            </a>
                                @* @if (item.ProdId == 1)
                        {
                            <div class="carousel-caps" style="position: absolute; top: 0; left: 0; right: 0; padding: 10px; background-color: rgba(255, 255, 255, 0); font-weight: bold; color: black;">
    <h5 style="font-size: 18px; color: blue;">Upto <b>40-50%</b> OFF on Electronics</h5>
</div>

                        } *@
                        </div>
                    }
                }
            </div>

            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleAutoplaying" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleAutoplaying" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>

        <div class="carousel-caption">
           @* <img src="https://w7.pngwing.com/pngs/707/352/png-transparent-web-development-e-commerce-service-marketing-contact-page-girl-hand-recruiter-girl.png" alt="Start Image" style="width: 100px;"> *@
            <h4 style="font-size: 30px; font-weight: bold; color: red;">Great Indian Deals</h4>
    <p style="font-size: 15px;color: blue;">End of Season Sales</p>
    <p style="font-size: 15px; color: black;">
        31<span style="display: inline-block; vertical-align: super; font-size: 12px; font-weight: bold;">st</span> June 2023
    </p>
            @* <img src="https://w7.pngwing.com/pngs/107/787/png-transparent-graphy-computer-female-customer-service-microphone-face-hand.png" alt="End Image" style="width: 250px;"> *@
        </div>
     <div style="position: absolute;display: flex; justify-content: flex-end;top: 50%; left: 80%; transform: translate(-50%, -50%);">
    <img src="../../../Assets/femimg.png" alt="Image" style="width: 300px; height: 262px;" />
</div>

    </div>
</div>







<section>
  <div class="container my-5">
    <header class="mb-4">
      <h3>New products</h3>
    </header>
    @if (Product != null && Product.Any())
    {
        <div class="row">
          @foreach (var product in Product)
          {
            <div class="col-lg-3 col-md-6 col-sm-6 d-flex">
              <a href="@($"/details/{product.ProdId}")">
                <div class="shadow-lg card w-100 my-2 shadow-2-strong">
                  <img src="@product.ImageURL" class="card-img-top" style="aspect-ratio: 1 / 1" />
                  <div class="card-body d-flex flex-column">
                    <h5 class="card-title">@product.ProdName</h5>
                    <p class="card-text">@product.Price.ToString("c")</p>
                    <div class="card-footer d-flex align-items-end pt-3 px-0 pb-0 mt-auto">
                      <a href="" class="btn btn-light border px-3 pt-2 icon-hover mx-4 btn-hover-highlight" title="Add to cart"
                      data-product-id="@product.ProdId"
                      data-product-image="@product.ImageURL"
                      data-product-name="@product.ProdName"
                      data-product-price="@product.Price"
                      onclick="addToCart(event)">
                        <i class="bi bi-cart4" style="font-size: 2rem;"></i>
                      </a>

                      <a href="" class="btn btn-light border px-3 pt-2 icon-hover mx-4 btn-hover-highlight" title="Add to wishlist"
                      data-product-id="@product.ProdId"
                      data-product-image="@product.ImageURL"
                      data-product-name="@product.ProdName"
                      data-product-price="@product.Price"
                      onclick="addToWishlist(event)">
                        <i class="bi bi-heart text-danger" style="font-size: 2rem;"></i>
                      </a>
                    </div>
                  </div>
                </div>
              </a>
            </div>
          }
        </div>
    }
    else
    {
        <p>No new products available.</p>
    }
  </div>
</section>







